# CSV 檔案去重整合工具

這是一個用於整合多個 CSV 檔案，去除重複資料並匯出為單一 CSV 的 Python 工具。

## 功能特點

- ✅ 自動建立 `parsed_questions_csv` 資料夾用於存放 CSV 檔案
- ✅ 逐個讀取並整合 CSV 檔案
- ✅ 自動篩選並保留「題目」和「答案」欄位
- ✅ 即時顯示每個檔案的重複筆數
- ✅ 自動去除重複資料
- ✅ 匯出整合後的結果為 CSV 檔案

## 安裝相依套件

```bash
pip install -r requirements.txt
```

或手動安裝：

```bash
pip install pandas
```

## 使用方法

1. **執行程式**（首次執行會自動建立 `parsed_questions_csv` 資料夾）：

```bash
python merge_csv.py
```

2. **將你的 CSV 檔案放入 `parsed_questions_csv` 資料夾**

3. **再次執行程式進行整合**：

```bash
python merge_csv.py
```

4. **查看結果**：整合後的資料會儲存在 `merged_output.csv` 檔案中

## 輸出範例

```
============================================================
CSV檔案去重整合工具
============================================================
✓ 已建立資料夾: /path/to/parsed_questions_csv

開始整合處理...

找到 5 個csv檔案
============================================================

[1/5] 正在處理: 1_1.csv
  - 檔案包含 100 筆資料（原始欄位：5 欄）
  - 已篩選保留 2 個欄位：題目、答案
  - 本次整合發現 0 筆與已合併資料重複
  - 目前累計總資料: 100 筆

[2/5] 正在處理: 1_2.csv
  - 檔案包含 150 筆資料（原始欄位：5 欄）
  - 已篩選保留 2 個欄位：題目、答案
  - 本次整合發現 10 筆與已合併資料重複
  - 目前累計總資料: 240 筆

[3/5] 正在處理: 1_3.csv
  - 檔案包含 120 筆資料（原始欄位：5 欄）
  - 已篩選保留 2 個欄位：題目、答案
  - 本次整合發現 5 筆與已合併資料重複
  - 目前累計總資料: 355 筆

============================================================
整合完成！統計資訊：
  - 總共讀取: 370 筆資料
  - 重複資料: 15 筆
  - 去重後資料: 355 筆
============================================================

✓ 成功匯出CSV檔案: /path/to/merged_output.csv
  檔案大小: 45.23 KB
  資料欄位: ['題目', '答案']
  資料列數: 355

============================================================
程式執行完畢
============================================================
```

## 檔案說明

- `merge_csv.py` - 主程式檔案
- `requirements.txt` - Python 相依套件清單
- `parsed_questions_csv/` - 存放待整合的 CSV 檔案的資料夾（自動建立）
- `merged_output.csv` - 整合後的輸出檔案

## 注意事項

- 程式會自動偵測並去除完全相同的資料列
- 支援 `.csv` 格式的檔案
- 程式會自動篩選並只保留「題目」和「答案」兩個欄位
- 如果 CSV 檔案缺少「題目」或「答案」欄位，該檔案會被跳過並顯示警告
- 輸出的 CSV 檔案使用 UTF-8-BOM 編碼（utf-8-sig），可在 Excel 中正確顯示中文
- 如果資料夾中沒有 CSV 檔案，程式會提示並退出
- 重複檢測是基於「題目」和「答案」兩個欄位的完整匹配

## 自訂設定

如需修改輸入資料夾或輸出檔案名稱，可以編輯 `merge_csv.py` 中的 `main()` 函式：

```python
def main():
    # 修改輸入資料夾名稱
    input_folder = 'parsed_questions_csv'  # 改為你想要的資料夾名
    
    # 修改輸出檔案名稱
    merge_csv_files(input_folder=input_folder, output_file='merged_output.csv')
```

