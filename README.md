# XLSX 檔案去重整合工具

這是一個用於整合多個 xlsx 試算表檔案，去除重複資料並匯出為 CSV 的 Python 工具。

## 功能特點

- ✅ 自動建立 `xlsx_files` 資料夾用於存放 xlsx 檔案
- ✅ 逐個讀取並整合 xlsx 檔案
- ✅ 即時顯示每個檔案的重複筆數及詳細行位
- ✅ 自動去除重複資料
- ✅ 匯出整合後的結果為 CSV 檔案

## 安裝相依套件

```bash
pip install -r requirements.txt
```

或手動安裝：

```bash
pip install pandas openpyxl
```

## 使用方法

1. **執行程式**（首次執行會自動建立 `xlsx_files` 資料夾）：

```bash
python merge_xlsx.py
```

2. **將你的 xlsx 檔案放入 `xlsx_files` 資料夾**

3. **再次執行程式進行整合**：

```bash
python merge_xlsx.py
```

4. **查看結果**：整合後的資料會儲存在 `merged_output.csv` 檔案中

## 輸出範例

```
============================================================
XLSX檔案去重整合工具
============================================================
✓ 已建立資料夾: /path/to/xlsx_files

開始整合處理...

找到 3 個xlsx檔案
============================================================

[1/3] 正在處理: file1.xlsx
  - 檔案包含 100 筆資料
  - 本次整合發現 0 筆重複資料
  - 目前累計總資料: 100 筆

[2/3] 正在處理: file2.xlsx
  - 檔案包含 150 筆資料
  - 本次整合發現 10 筆重複資料
  - 重複行詳情：
    [1] 檔案第 15 行與之前已整合的資料重複
        內容: 張三 | 25 | 台北 | ...
    [2] 檔案第 23 行與檔案第 12 行重複
        內容: 李四 | 30 | 台中 | ...
    ... 還有 8 筆重複資料未顯示
  - 目前累計總資料: 240 筆

[3/3] 正在處理: file3.xlsx
  - 檔案包含 120 筆資料
  - 本次整合發現 5 筆重複資料
  - 重複行詳情：
    [1] 檔案第 8 行與之前已整合的資料重複
        內容: 王五 | 28 | 高雄 | ...
    ... 還有 4 筆重複資料未顯示
  - 目前累計總資料: 355 筆

============================================================
整合完成！統計資訊：
  - 總共讀取: 370 筆資料
  - 重複資料: 15 筆
  - 去重後資料: 355 筆
============================================================

✓ 成功匯出CSV檔案: /path/to/merged_output.csv
  檔案大小: 45.23 KB
  資料欄數: 8
  資料列數: 355

============================================================
程式執行完畢
============================================================
```

## 檔案說明

- `merge_xlsx.py` - 主程式檔案
- `requirements.txt` - Python 相依套件清單
- `xlsx_files/` - 存放待整合的 xlsx 檔案的資料夾（自動建立）
- `merged_output.csv` - 整合後的輸出檔案

## 注意事項

- 程式會自動偵測並去除完全相同的資料列
- 支援 `.xlsx` 格式的 Excel 檔案
- 輸出的 CSV 檔案使用 UTF-8-BOM 編碼，可在 Excel 中正確顯示中文
- 如果資料夾中沒有 xlsx 檔案，程式會提示並退出
- 重複行的行號是指 Excel 中的行號（第1行為標題，資料從第2行開始）
- 預設最多顯示 10 筆重複資料的詳細資訊，超過的會以總數顯示

## 自訂設定

如需修改輸入資料夾或輸出檔案名稱，可以編輯 `merge_xlsx.py` 中的 `main()` 函式：

```python
def main():
    # 修改輸入資料夾名稱
    input_folder = 'xlsx_files'  # 改為你想要的資料夾名
    
    # 修改輸出檔案名稱
    merge_xlsx_files(input_folder=input_folder, output_file='merged_output.csv')
```

